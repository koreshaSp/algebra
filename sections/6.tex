\section{Лекция 6}
\subsection{TODO}
\begin{remark}
    По результатом прошлой лекции мы поняли,
    что любое элементарное преобразование системы
    это умножение на верхне или нижне треугольную матрицу.
\end{remark}
\begin{remark}
    Заметим, некоторые свойства верхнетреугольных матриц. $LT_n(K)\subseteq M_n(K)$ 
    \begin{enumerate}
        \item Подкольцо
        \item Подпространство
    \end{enumerate}
\end{remark}
\begin{proof}
    Докажем, что это подкольцо, а именно произведение нижнетреугольных матриц опять таки
    нижнетреугольная. Можно проверить, что в $i$ столбце, все элементы выше, чем $i$ 
    должны быть равны нулю.
    \[
    \begin{pmatrix}
        & 0\\
        *&
    \end{pmatrix}
    \begin{pmatrix}
        & 0\\
        *&
    \end{pmatrix}=
    .\] 
     TODO: картиночка с пояснением

     Получается, что доказали замкнутость умножения. Замкнутость сложения очевидна,
     единица в кольце, это просто единичная матрица. 
     
     Отдельно стоит отметить, что это кольцо \textbf{не коммутативно}.
\end{proof} 
\begin{motivation}
    Заметим, что у нас получился объект, который является и кольцом и пространством, давайте
    введём соответ определение.
\end{motivation}
\begin{definition}
    $A$~--- кольцо, $K$~--- поле.
    $\cdot: A\mapsto A$. $A$~--- алгебра, если 
     \begin{enumerate}
         \item $A,+,\cdot$~--- векторное пространство.
         \item $\lambda(AB) = (\lambda A)B = A(\lambda B), \forall \lambda\in K, A,B\in A$
    \end{enumerate}
\end{definition}
\begin{example}
    $\C$~--- алгебра над $\R$. В общем случае: $K\subseteq L$~--- расширение полей.
\end{example}
\begin{statement}
     Вообще любое конечномерное пространство может быть достроено до алгебры:
     а именно можно представлять себе пространство матриц размера $\dim U$.
\end{statement}
\subsection{Обратные матрицы для верхне-нижнетреугольных}
\begin{statement}
     $L\in LT_n(K)$. $L$~--- обратимая $\Rightarrow L^{-1}\in LT_n(K)$.
\end{statement}
\begin{proof}
    Есть 3 доказательства этого факта.
    \begin{enumerate}
        \item Алгебраическое доказательство.\\
            $$L = 
            \begin{pmatrix}
                \lambda_1&&&\\
                *&\lambda_2&&\\
                *&*&\ddots&&\\
                *&*&\dots&*&\lambda_n
            \end{pmatrix}$$
            Причём $\lambda_i$~--- не нули. Тогда определим $D$~--- следующим способом.
            \[
            D = \begin{pmatrix}
                \lambda_1&&&0\\
                &\lambda_2&&\\
                &&\ddots&&\\
                0&&\dots&\lambda_n
            \end{pmatrix}
            .\] 
            Заметим, что $L = D(E_n + N)$
            $D^{-1}L = E_n + N$. 
            $L^{-1} = (E_n + N)^{-1}D^{-1}$ 
            Теперь подумаем о $\frac{1}{1+x} = 1 - x + x^2 +\dots +(-1)^nx^n\dots$,
            но в пространстве матриц.
            Но говорить о бесконечной сумме нехорошо, поэтому давайте убедимся,
            что с какого-то момента хвост этой суммы равна нулю.

            Заметим, что на главной диагонали матрицы $N$ стоят нули. Поэтому, хочется
            показать, что $N^n = 0$, тогда наша сумма корректна.
            Посмотрим на подпространство $\langle e_n,\dots, e_i\rangle = U_i$.
            $N(U_i)\in U_{i+1}$, где $N$ рассмотрено как линейное отображение.
            Иначе говоря, при каждом умножении на $N$ мы отсекаем часть нашего пространства
            и когда-нибудь дойдём до пустого(в том числе точно дойдём, если выкинем все вектора).
            То есть $N^n = 0$. 

            Теперь проследим следующий момент:
            $$(E_n - N + \dots, (-1)^{n-1}N^{n-1})(E_n + N)=
            (E_n - N + \dots + (-1)^{n-1}N^{n-1} + N - N^2 + \dots + (-1)^{n-1}N^n)=
            $$. Все элементы при степенях меньших $n$ сократятся, а элемент при $N^n$ можно 
            выкинуть, так как $N^n = 0$ 
        \item
             \[
            L = 
            \begin{pmatrix}
                \lambda_1&&&\\
                *&\lambda_2&&\\
                *&*&\ddots&&\\
                *&*&\dots&*&\lambda_n
            \end{pmatrix}
             .\] 
             Причём $\lambda_i \not= 0\forall i$, иначе матрица необратима.
             Заметим, что при применении метода Гаусса на этой матрицы, мы никогда не
             меняем местами строки, так как $a_{i,i} \not= 0$.

             Вторым интересным фактом является то, что всё время работы алгоритма матрица
             остаётся нижнетреугольной. Это нам даёт следующее.
             $L_n\ldots L_2L_1L=D$, где $D$~--- диагональная матрица(см док-во 1).
             Хотим из этого выражения выразить $L^{-1}$. Для этого множим на $L^{-1]}$ справа
             и на $D^{-1}$ слева. В итоге получили: $D^{-1}L_n\ldots L_2L_1 = L^-1$. 
             Цель достигнута, нашли обратную матрицу.
    \end{enumerate}
\end{proof}
\begin{definition}
    $GL_n(K)$~--- множество всех обратимых матриц размера $n\times n$.
\end{definition}
\begin{motivation}
    Хотим улучшить метод Гаусса, для случая, где все элементы главной
    диагонали не равны нулю. Это избавляет нас от перестановки строк(второму элементаному
    преобразованию) для того, чтобы искать все обратимые матрицы.

    Мы ищем $A\in GL_n(K)$.
    После работы Гаусса $L_k\ldots L_1A = U$, где все $L_i$~--- нижнетреугольные,
    $U$~--- верхнетреугольная просто по инварианту алгоритма Гаусса.
    Обозначим за $L = (L_k\ldots L_1)^{-1}$, тогда 
    $A = LU$, где $L$~--- нижнетреугольная матрица, причём у $L$~--- единицы на диагонали.
    Поймём, когда это разложение существует, 
\end{motivation}
\begin{definition}
    Главной подматрицей матрицы $A$ размера $s$ назовём левую верхнюю подматрицу
    размера $s\times s$.
\end{definition}
\subsection{LU разложение в методе Гаусса}
\begin{theorem}
    Пусть $A\in GL_n(K)$ тогда равносильны:
    \begin{enumerate}
        \item $\exists U\in UT_n(K), L\in LT_n(K) A = LU$
        \item все главные подматрицы обратимы
        \item В методе Гаусса не используются перестановки строк(преобр 2 типа)
    \end{enumerate}
\end{theorem}
\begin{proof}\leavevmode
    \begin{itemize}
        \item $3\Rightarrow 1$ уже доказано
        \item  $1\Rightarrow 2$ докажем\\
            Заметим, что раз уж $A$~--- обратимая, то $L, U$~--- тоже обратимые, а это
            значит, что на главных диагоналях нет нулей.
            TODO(каритиночка)
            Перемножим блочно главные подматрицы $L, U$ одна из них верхнетреугольная, а
            другая нижнетреугольная, причём на их главных диагоналях все элементы ненулевые.
            Тогда получается, что их произведение (а именно главная подматрица $A$) обратима.
        \item $2\Rightarrow 3$ Докажем по индукции\\
            Утверждение: пусть главная подматрица размера $k$~--- обратима и все меньшие, тоже
            обратимы, тогда в методе Гаусса не используется перестановка строк в первых $k$ итерациях.
            База очевидна. Переход: в первых $k$ шагах мы первые верхние строчки($<k$) прибавляли к
            нижним($>k$). В исходной матрицей первые $k$ столбцов линейно независимы, а значит после
            применения метода Гаусса первые $k$ столбцов тоже линейно независимы. Но, если $k$ элемент
            равен нулю и требуется перестановка, то получается противоречие с линейной независимостью.
    \end{itemize}
\end{proof}
\begin{statement}
    $A = LU, A = L_2U_2$, причём $L_1,L_2$~--- нижнетреугольные, $U_1, U_2$~--- верхнетреугольные,
    причём в $L_1,L_2, U_1,U_2$ нет нулей на главной диагонали. Тогда $U_1=U_2, L_1 =L_2$.
\end{statement}
\begin{proof}
    $L_1U_1 = L_2U_2\Rightarrow L_2^{-1}L_1 = U_2U_1^{-1}$. Слева у нас 
    нижнетреугольная матрица, а справа верхнетреугольная, тогда равенство значит,
    что они обе на самом деле просто диагональные, причём с единицами на диагонали, 
    а это значит, что $L_1U_1 = E_n$.
\end{proof}
\begin{remark}
    Теперь давайте поиспользуем наше знание о разложении матрицы на множители для 
    решения системы линейных уравнений.
    Есть разложение $A = LU$.
    Хотим решать $Ax = b$, 
    тогда можно эту систему как систему
    \[
    \begin{cases}
        Ly = B\\
        Ux = y
    \end{cases}
    .\] 
    Каждое из уравнений системы мы умеем решать за $O(n^2)$,
    а находить разложение можно за $O(n^3)$.

    На самом это полезно, когда у нас есть фиксированная матрица $A$ и 
    нам надо решить много уравнений при различных $b$.
    На самом деле можно делать ещё и так:
    $x = A^{-1}b$, такое решается за  $O(n^2)$.
\end{remark}
\begin{motivation}
    TODO Затехать упражнение про инвариант разложения матрицы $A$.
\end{motivation}
\begin{example}
    Часто применяется для решения диффуров. 
    $\frac{d^2f}{dx^2} + u(x)\frac{dt}{dx} = F$, зная, что $f(0) = a_1, f(1) = a_2$.
    В таких случаях обычно ищут приближённое значение $f$ в точках 
    $k\in[0,n], f(\frac{k}{n})=?$. Тогда в исходном уравнении делается замена:
    $$f''(x)\simeq \frac{f(x-h)+f(x+h)-2f(x)}{h^2}$$,
    $$f'(x)\simeq \frac{f(x+h) - f(x - h)}{2h}$$.
    Оказывается, что в таких случаях помогает $LU$ разложение.
\end{example}
\begin{example}
    $P_\sigma(e_i)= e_{\sigma(i)}$~--- матрицы перестановки.
     \[
         (P_\sigma)_{i,j} = \begin{cases}
             1, i = \sigma(j)\\
             0, \text{иначе}
         \end{cases}
    .\]
    Упражнение: доказать, что $A\in GL_n(k), \exists L, U, P\colon PA = LU$. 
    Как будем подбирать эту перестановку? TODO(потерял мысль)
\end{example}
\begin{remark}
    Иногда $LU$ разложение позволяет решать проблемы точности дробных чисел(см Pivotiong).
\end{remark}
\subsection{Определитель}
\begin{motivation}
    Хотим иметь характеристику матрицы, отражающую насколько она близка к обратимой.
\end{motivation}
\begin{remark}
    $\R^3(\R^n)$.
    Тогда матрица будет необратима, когда все её вектора лежат в одной плоскости.
    Давайте зададим параллелипипед следующим образом.
    $D(v_1,\dots, v_n) = \{\lambda_iv_i\mid \lambda\in [0, 1]\}$. Достаточно очевидно,
    что  $Vol(D(v_1,\dots, v_n))=0\Leftrightarrow v_1,\dots, v_n$~--- линейно независимы.
\end{remark}
