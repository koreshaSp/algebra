\section*{Лекция 16.04}
\begin{motivation}
    В прошлый раз мы пользовались тем, что алгебраическая кратность равна геометрической. Хотим понять в каких случаях это условие
    выполняется. Спойлер: не везде выполнено, но если расширить пространство до алгебраического замыкания(например $\R$ заменить на $\C$),
    то это условие будет выполнено всегда.
\end{motivation}
\begin{example}
    Пример, когда алгебраическая кратность не равна геометрической.
     \[
         A = 
         \begin{pmatrix}
             0 & 1\\
             0 & 0
         \end{pmatrix}
    .\] 
    $\chi_A(t) = t^2$, причём $Ker A = \langle\rangle$
\end{example}
\begin{definition}
    $A$~--- жорданова клетка размера $k$ для собственного числа $\lambda$, если
     \[
         A = 
         \begin{pmatrix}
             \lambda & 1 & \dots 0\\
             0 & \lambda & \ddots & \vdots\\
             \vdots&\vdots&\ddots&\vdots\\
             0 & \dots & \lambda & 1\\
             0 & \dots & \dots & \lambda\\
         \end{pmatrix}
    .\] 
    Заметим, что $\chi_A(t) = (-1)^k(t-\lambda)^k= (\lambda-t)^k$,  $\dim Ker(A - \lambda E) = 1$
\end{definition}
\begin{definition}
    TODO(дописать)
    $U\le V$ инвариантно относительно $A$. $AU \subseteq V$
\end{definition}
\begin{remark}
    Если $v$~--- собственный вектор для $A$, то $\langle v \rangle$~--- инвариантное подпространство.
    $\dim U = 1$ и $U$~--- инвариантное, тогда $U = \langle v\rangle$, где  $v$~--- собственный для $A$.
\end{remark}
\begin{examples}
    \begin{enumerate}
        \item
            $Ker A$~--- инвариантное.
        \item
             $Im A$~--- инвариантное.
         \item
             $p(x)\in K[x]$, $p(A) = a_0 + a_1 A + a_2 A^2 + \dots a_n A^n$.
             Заметим, что в этом случае есть очень удобное свойство:
             $(p(x)q(x))|_{x = A} = p(A)q(A) + \dots + a_n A^n$
         \item Смотря на прошлый пример легко заметить, что $Ker\ p(A)$~--- инвариантно относительно $A$.
             Для этого необходимо и достаточно, чтобы $p(A)(Ax) = 0$.
             Так как многочлен $p(A)$ коммутирует с этой матрицей $A$.
             %TODO расписать поподробнее

     \end{enumerate}
\end{examples}
\begin{remark}
    $\langle v_1,\dots, v_k\rangle = U$ инвариантно относительно $A$. $v_1,\dots, v_k, v_{k + 1},\dots v_n$~--- базис $V$.
    Если каждый столбец $i$ соответствует вектору $v_i$, то получаем матрицу.
    \[
        A = 
        \left(\begin{array}{c|c}
                A|_U & *\\
                \hline
                0 & A|_{V/U}
        \end{array}\right)
    .\] 
    Что такое $V/U$ мы не обсуждали, но нам это не очень понадобиться, поэтому можно считать, что в правой нижней части стоит что
    угодно. 
    
    Важно отметить то, что правая верхняя часть не влияет на характеристический многочлен.
\end{remark}
\begin{remark}
    В специфическом случае
    $V = U_1 \oplus U_2$. прямая сумма инвариантных подпространств. Прошлое замечание приобретает вид:
     \[
         \left(\begin{array}{c|c}
                 A|_{U_1} & 0\\
                 \hline
                 0 & A|_{U_2}
         \end{array}\right)
    .\] 
\end{remark}
\begin{theorem}
    $A$~--- оператор на пространстве $V$. $p(x), q(x)$~--- многочлены, для которых выполнено: 
     \begin{enumerate}
         \item $pq(A) = 0$ (свойство называется аннуляция оператора)
         \item $(p, q) = 1$
    \end{enumerate}
    Тогда в этом случае $V = \ker p(A) \oplus \ker q(A)$.
\end{theorem}
\begin{proof}
    То, что $(p,q) = 1$ значит, что 
    $h(x)p(x) + g(x)q(x) = 1$(так как существует линейное разложение их НОД).
    А из этого можно получить следующее тождество, если переписать это на языке операторов: $h(A)p(A) + g(A) q(A) = E$.
    Домножив обе части на вектор $v$, получим, что $h(A)(p(A)v) + g(A)(q(A)v) = v$.
    Допустим $p(A)v\in \ker q(A), q(A)v\in \ker p(A)$, тогда в равенстве выше 
    %TODO разобраться и переписать
    Докажем, что $p(A)v\in \ker q(A)$. $q(A)p(A)v = (pq)(A)v = 0, v = 0$.

    $x\in \ker p(A)\cap \ker q(A)$. Хотим показать, что $x = 0$.
    Из того, где лежит  $x$ следует, что $p(A)x = 0 = q(A)x$.
    Тогда в равенстве $h(A)(p(A)v) + g(A)(q(A)v) = v$ с обоих сторон находятся нули.
\end{proof}
\begin{remark}
    Посмотрим на набор операторов: $E, A, A^2, \dots$. Размерность пространства операторов конечномерно(и равно $(\dim V)^2$).
    Утверждается, что всегда есть многочлен, который обнуляется на $A$.
    Тогда набор является линейно зависимым, тогда $\exists c\colon c_0E + c_1A + c_2A^2 + \dots +c_k A^k = 0$.
\end{remark}
%TODO пропустил какой-то утверждение про то, что пространство раскладывается на ядра многочленов от A.
\begin{motivation}
    Хотим понять, как устроено действие ядра $A$ на подпространстве $\ker (A - \lambda_iE)^{\alpha_i}$.
    Иначе говоря к какому виду можно привести матрицу оператора $A$ в этом случае.
\end{motivation}
\begin{remark}
    $A - \lambda_iE$ на пространстве $\ker(A - \lambda_iE)^{\alpha_i}$ является нильпотентом.
    Так как $(A - \lambda_iE)^{\alpha_i} = 0$
\end{remark}
\begin{motivation}
    Таким образом вся классификация сводится к классификации нильпотентных элементов.
\end{motivation}
\begin{remark}
    %TODO Перенести в definition
    $J_k(\lambda)$~--- жорданова матрица.
    $J_k(\lambda) - \lambda E$~--- нильпотент.
\end{remark}
\begin{theorem}
    $A\colon V\mapsto V$. $K$~--- алгебраически замкнуто, $\exists$ базис $e$.
    Тогда 
     \[
         [A]^e_e =
         \begin{pmatrix}
             J_k(\lambda_1) & \dots & 0\\
             \vdots & \ddots & \vdots\\
             0 & \dots & J_k(\lambda_n)
         \end{pmatrix}
    .\] 
    \begin{definition}
        Такой базис $e$ будем называть жордановым базисом.
    \end{definition}
    Такой вид матрицы $[A]^e_e$ единственный с точностью до перестановки блоков.
    Иначе говоря, какие бы два жордановых базиса мы не взяли, то жорданова форма будет одинакова с точностью до перестановки блоков.
    %TODO: есть переформулировка данной теоремы.
\end{theorem}
\begin{proof}
    Докажем единственность, а существование сказали посмотреть в конспекте).
    Посмотрим какие числа могут стоять на диагонали. Очевидно, что это всегда собственные числа $\lambda_i$ матрицы $A$.
    $\chi_A(t) = \chi_J(t) = \pm\prod\limits_{}^{}{(t-\lambda_i)^{k_i}}$.

    Знаем, что у каждого $\lambda_i$ есть алгебраическая кратность. Заметим, что эта величина не зависит от выбора базиса.
    Алгебраическая кратность каждого $\lambda_i$ равна следующему: $\sum\limits_{\lambda_j=\lambda_i}^{}{k_j}$~--- сумма размеров
    клеток для $\lambda_i$. Геометрическая кратность $\lambda_i$  равна 
    $\dim \ker [A- \lambda_iE]^e_e = \dim \ker (J - \lambda_iE)$, что равно количеству клеток с собственным числом $\lambda_i$.

    $[\dim\ker(A - \lambda_iE)^{\alpha_i}]$, хотим понять можно ли по этому набору восстановить ${K_s}$ для 
    фиксированного $\lambda_i$.
\end{proof}
