\section{Лекция 28.02}\label{3}
\subsection{Доказательство формулы Грассмана}
\begin{proof}
    Будем доказывать \hyperref[thm:Формула Грассмана]{формулу Грассмана} из прошлой лекции.

    Пользуясь \hyperref[thm:О дополнении до базиса]{теоремой о дополнении до базиса}
    и тем, что $V$~--- конечномерное(а значит и все его подпространства)
    построим базис для пространства $U_1\cap U_2$ и назовём его $\langle e_1,\dots, e_k\rangle$. 
    Теперь, пользуясь снова пользуясь \hyperref[thm:О дополнении до базиса]{теоремой о дополнении до базиса},
    этот набор можно достроить до базисов $U_1$ и $U_2$,
    добавив к нему $f_1,\dots,f_l$ и $g_1,\dots,g_n$, соответственно.

    Таким образом, доказательство свелось факту: $\langle e_1,\dots,e_k,f_1,\dots,f_l,g_1,\dots,g_n\rangle$~---
    базис $U_1+U_2$.
    \begin{enumerate}
        \item Система выше порождающая, так как 
            $\forall v\in U_1 + U_2 \Rightarrow \exists u_1\in U_1, u_2\in U_2\colon v = u_1+u_2$.
            просто по определению суммы векторных пространств. А $u_1$ и $u_2$ представляются как линейная
            комбинация базисов 
            $\langle e_1,\dots,e_k,f_1,\dots,f_l\rangle$ и $\langle e_1,\dots,e_k,g_1,\dots,g_n\rangle$
            соответственно.
        \item
            Доказательство линейной независимости проведём от обратного.
            А именно, предположим, что у нас есть линейная комбинация, а затем докажем её тривиальность.
            Пусть $\sum\limits_{i=1}^{k}\lambda_ie_i +
                   \sum\limits_{i=1}^{l}\mu_if_i + 
                   \sum\limits_{i=1}^{n}\eta_ig_i = 0$.
            Перенесём последнее слагаемое в правую часть и посмотрим на:
                $\sum\limits_{i=1}^{k}\lambda_ie_i +
                 \sum\limits_{i=1}^{l}\mu_if_i = 
                -\sum\limits_{i=1}^{n}\eta_ig_i$
            Тогда вектор, равный левой части находится в $U_1$, так как является линейной комбинацией
            базисных, а равный правой части~-- в $U_2$ по аналогичной причине. Но у нас, есть верный знак
            равенства между частями, а это значит, что это один и тот же вектор, который принадлежит $U_1\cap U_2$.
            Получается, что $\sum\limits_{i=1}^{k}\lambda_ie_i + \sum\limits_{i=1}^{l}\mu_if_i \in U_1\cap U_2$,
            а такое бывает, только если все $\mu_i = 0$(тут мы неявно пользуемся единственностью разложения
            вектора через базис).

            Проведя аналогичное рассуждение для слагаемого $\sum\limits_{i=1}^{n}\eta_ig_i$ получим, что все
            $\eta_i = 0$. Получим, что наше изначальное выражение упростилось до 
            $\sum\limits_{i=1}^{k}\lambda_ie_i = 0$, откуда следует, что все $\lambda_i = 0$, так как они
            являются базисом $U_1\cap U_2$, ну а значит линейно независимы.
    \end{enumerate}
    Таким образом, мы доказали, что $\langle e_1,\dots,e_k,f_1,\dots,f_l,g_1,\dots,g_n\rangle$~---
    базис $(U_1 + U_2)$. Всё, что нам осталось проверить, это равенство на размеры пространств:
    $\dim U_1 + \dim U_2 = \dim(U_1 \cap U_2) + \dim(U_1 + U_2)$.
    $\dim (U_1\cap U_2) = k, \dim U_1 = k + l, \dim U_2 = k + n, \dim U_1 + U_2 = k + l + n$.
    Подставим это в формулу: $(k + l) + (k + n) = k + (k + l + n)$. Всё сошлось.
\end{proof}
\subsection{Прямая сумма подпространств}
\begin{definition} 
    $U_1, U_2\le V$. Будем писать $U_1 \oplus U_2 = V$ и называть это \textbf{прямой суммой}, если
    $\forall v\in V, \exists! u_1\in U_1, u_2\in U_2\colon u_1 + u_2 = v$.
\end{definition}
\begin{motivation}
    Бывает полезно для решения задач, которые мы умеем решать на пространстве малой размерности, для
    перехода к большим размерностям.
\end{motivation}
\begin{statement}
    $V = U_1\oplus U_2\Leftrightarrow (\text{базис } U_1 \cup  \text{базис } U_2) = \text{базис } V$.
\end{statement}
\begin{proof}
    Пусть $E = \{e_1,\dots, e_n\}$, $F = \{f_1,\dots,f_m\}$~--- базисы $U_1$, $U_2$ соответственно.
    $\ora$:
        \begin{enumerate}
            \item $E\cup F$~--- образующая $V$ так как любой элемент из $V$ представим в виде суммы элементов
                из $U_1$ и $U_2$, а значит представим и в виде комбинации их базисов.
            \item $E\cup F$~--- линейно независимый. 
                $\sum\limits_{i=1}^{n} \lambda_ie_i + \sum\limits_{i=1}^{m} \mu_if_i = 0$. 
                Заметим, что $0$, как и любой вектор $V$, расписывается в виде суммы $u_1\in U_1, u_2\in U_2$,
                единственным образом, и это $0 + 0 = 0$. Так, как
                $\sum\limits_{i=1}^{n} \lambda_ie_i \in U_1$, $\sum\limits_{i=1}^{m} \mu_if_i \in U_2$,
                то единственная ситуация, когда их сумма равна нулю это:
                $\sum\limits_{i=1}^{n} \lambda_ie_i = 0$ и $\sum\limits_{i=1}^{m} \mu_if_i = 0$,
                что бывает только при тривиальной комбинации коэффициентов.
        \end{enumerate}
    $\ola$:
        Каждый элемент $v\in V$ раскладывается в виде линейной комбинации $E\cup F$, так как этот набор
        просто совпадает с базисом $V$. Осталось доказать только единственность этого разложения. 
        Пусть получилось так, что какой-то вектор $v$ имеет два различных разложения
        $v = u_1 + u_2 = u_1' + u_2', u_1, u_1'\in U_1, u_2,u_2' \in U_2$, тогда просто вычтем 
        одно из другого и получим нетривиальное разложение нуля, а именно 
        $(u_1 - u_1') + (u_2 - u_2') = 0$, где
        $(u_1, u_2) \neq (u_1', u_2')$. Получаем противоречие с тем,
        что $E\cup F$~--- базис $V$, так как мы нашли нетривиальное разложение нуля в
        линейную комбинацию $E \cup F$, а это значит что данный набор линейно зависим.
\end{proof}
\begin{remark}
    $V = U_1\oplus U_2 \Leftrightarrow V = U_1 + U_2,  U_1 \cap U_2 = \{0\}$. 
\end{remark}
\begin{proof}
    \textsl{Оставили как упражнение, но вот вариант, как это сделать.}\\
     Далее $e, f$~--- базисы $U_1, U_2$ соответственно.
    $\ora$:
        \begin{itemize}
            \item $V = U_1 + U_2$ очевидно.
            \item $U_1 \cap U_2 = \{0\}$ Пусть $u\in U_1 \cap U_2$, значит $u = 
                \sum \lambda_i e_i = \sum \mu_i f_i \Rightarrow 
                \sum \lambda_i e_i - \sum \mu_i f_i = 0$. Откуда следует,
                так как $V = U_1 \oplus U_2$, то существует лишь
                одно разложение нуля, $0_{U_1} + 0_{U_2} = 0_{V} \Rightarrow \sum \lambda_i e_i = 0, 
                \sum \mu_i f_i = 0 \Rightarrow \lambda_i = \mu_i = 0, \forall i
                \Rightarrow u = 0$.
        \end{itemize}
    $\ola$:
        Выберем $v\in V$ и посмотрим на два его разложения на вектора из $U_1, U_2$
        $v = u_1 + u_2 = u_1' + u_2'$,
        тогда $\underbrace{u_1 - u_1'}_{\in U_1} = \underbrace{u_2 - u_2'}_{\in U_2}$.
        Так, как $U_1 \cap U_2 = \{0\}$, то из этого равенства следует, что 
        $u_1 - u_1' = u_2 - u_2' = 0$.
\end{proof}
\subsection{Линейное отображение}
\begin{motivation}
    Когда мы говорили про теорию групп, обсуждался гомоморфизм
    (отображение между группами, сохраняющее операции).
    Хотим получить нечто похожее, но для линейных пространств.
\end{motivation}
\begin{definition}
    $\faktor{V_1}{K},\faktor{V_2}{K}$~--- век. пр-ва. $L: V_1\mapsto V_2$ называется линейным отображением, если:
    \begin{enumerate}
        \item $L(v_1 + v_2) = L(v_1) + L(v_2)$
        \item $L(\lambda v) = \lambda L(v)$
    \end{enumerate}
\end{definition}
\begin{remark}
    В дальнейшем скобочки у линейных отображений зачастую будут опускаться.
\end{remark}
\begin{definition}
    Если $V_1=V_2$, то $L$ называется \textbf{оператором}.
    \remark В литературе часто все линейные отображения называют оператором.
\end{definition}
\begin{examples}
    \begin{enumerate}
        \item $$K^n\mapsto K^m, A\in M_{m\times n}(K)$$ $$x\rightarrow Ax$$
            Он особенно интересен тем, что далее будет доказано, что любой другой пример линейного 
            отображения в конечномерных пространствах будет сводиться к этому. Но сделать это
            можно разными способами, которые не всегда тривиальны. Подробнее об этих способах будет 
            рассказано далее по курсу.
        \item $$
            x\in K^n, \lambda\in K, V\to V
            $$ $$
            x\mapsto \lambda x $$
        \item $$
            f,g\in C\left([0, 1]\right), C\left([0,1]\right)\to C\left([0,1]\right)
            $$ $$
            f \mapsto fg $$
        \item $$
            C\left([0,1]\right)\to C\left([0,1]\right)
            $$ $$
            f\mapsto \int_0^x f dt$$
        \item
            $$C^1\left([0,1]\right)\rightarrow C\left([0,1]\right)$$
            $$f\rightarrow f'$$
        \item $$
            g: [0, 1]\mapsto [0, 1], C[0,1]\mapsto C[0,1]
            $$ $$
            f \rightarrow f\circ g $$
        \item
            $$
            f(y)\rightarrow \int_0^1K(x,y)f(y)dy = g(x)
            $$
            Где $K(x,y)$~--- непрерывная функция от 2 переменных.
        \item
            Оператор Лапласа
            $$
            f(x_1,\dots,x_n) = \frac{\delta^2}{\delta x_1^2}f + \dots + \frac{\delta^2}{\delta x_n^2}f=\Delta f
            $$
            Очень часто возникает в физике. Например: уравнение теплопроводности, волновое уравнение,
            формула мембраны, уравнение частицы в квантовом поле. Подробнее на \href{https://en.wikipedia.org/wiki/Laplace_operator}{википедии}.
    \end{enumerate}
\end{examples}
\begin{properties}
\item $L(0) = 0$.
\item $\lambda L$~--- линейное
\item $L_1 + L_2$~--- линейное
\item $L_1\circ L_2$~--- линейное
\item $L_1\circ(L_2 + L_3) = L_1 \circ L_2 + L_1 \circ L_3$
\item $(L_1 + L_2) \circ L_3 = L_1 \circ L_3 + L_2 \circ L_3$
\item $L_1 \circ (\lambda\cdot L_2) = \lambda\cdot L_1 \circ L_2$
\end{properties}
\begin{proof}
    \textbf{Оставили как упражнение}
\end{proof}
\begin{motivation}
    Все эти свойства нужны, чтобы легко отвечать на вопрос является ли линейным то или иное отображение.
\end{motivation}
\begin{theorem}[Линейное отображение определяется действием на базисных векторах]
    $V_1, V_2$~--- векторные пространства. $e_1,\dots,e_n$~--- базис $V_1$, $f_1,\dots,f_n\in V_2$.
    Тогда $\exists! L: V_1\to V_2\colon Le_i = f_i$, где $L$~--- линейное отображение.
\end{theorem}
\begin{proof}
    Для начала покажем единственность. Возьмём $u\in V_1$ и рассмотрим его единственное разложение по базису:
    $u = \sum\limits_{i=1}^{n}\lambda_ie_i$. Пользуясь свойствами линейного отображения распишем $Lu=
    \sum \limits_{i=1}^{n} \lambda_iLe_i = \sum \limits_{i=1}^{n} \lambda_i f_i$. А это значит, что значение
    в любой точке не зависит от значений $L$ на не базисных элементах.

    Теперь докажем корректность(линейность) такого отображения. Выделим каждое слагаемое в формуле выше 
    в следующем виде: $L_iu = \lambda_if_i$. Легко проверить, что $L_i$~--- линейное отображение.
    $$L_i(u_1) + L_i(u_2) =
    \lambda_{u_1,i}f_i + \lambda_{u_2,i}f_i=
    (\lambda_{u_1,i}+\lambda_{u_2,i})f_i=L_i(u_1 + u_2)$$
    Для умножения также очевидно. Тогда $L = \sum\limits_{i=1}^{n} L_i$
    тоже линейное как сумма линейных.
\end{proof}
\begin{follow}
    Для $\forall L: K^n\mapsto K^m$~--- линейное 
    $\exists! A\in M_{m\times n}(K)\colon Lx = Ax,\forall x\in K^n$
\end{follow}
\begin{proof}
    Заметим, что $A\times e_i$~--- $i$ый столбец матрицы $A$, где $e_i$~--- элемент стандартного базиса(см \hyperref[2]{лекция 2}).
    Далее будет обозначаться как $A_{*,i}$. Тогда очень просто по линейному отображению $L$ восстановить
    матрицу $A$ просто смотря куда переходят элементы $e_i$.
    Говоря подробнее, каждая пара $e_i, Le_i$ определяют столбец $A_{*,i}$.
    $$A=\Big(\big(Le_1\big),\dots,\big(Le_n\big)\Big)$$
    Тогда матрица $A$ просто по построению будет удовлетворять: $A \times e_i = L e_i \forall i$
    и определена однозначно. Но с другой стороны на матрицу $A$ можно посмотреть как на линейное
    преобразование $Ax$, тогда по теореме выше $Ax=Lx$ так как они совпадают на базисных векторах.
\end{proof}
\begin{remark}
    Пользуясь фактом выше, далее по курсу часто матрица будет отождествляться линейному отображению без явного
    указания этого, будьте внимательны.
\end{remark}
\begin{theorem}[Об обратном отображении линейного]
    $V,W$~--- векторные пространства. $L: V\mapsto W$~--- линейное отображение.
    \begin{enumerate}
        \item Если $L$~--- обратимое, тогда $L^{-1}$~--- тоже линейное.
        \item $L$~--- обратимо $\Leftrightarrow$ некоторый базис $V$ она переводит в базис $W\Leftrightarrow$ 
            любой базис $V$ она переводит в базис $W$.
    \end{enumerate}
\end{theorem}
\begin{proof}\leavevmode
    \begin{enumerate}
        \item 
            Хотим показать, что выполнено: $L^{-1}(u + v) = L^{-1}(u) + L^{-1}(v)$. Посмотрим на 
            $e_1 = L^{-1}(u), e_2 = L^{-1}(v)$. Тогда доказываемое равенство можно записать следующим
            образом: 
            $$L^{-1}\big(L(e_1) + L(e_2)\big) = L^{-1}\big(L(e_1 + e_2)\big) = e_1 + e_2 =
            L^{-1}(u) + L^{-1}(v)$$
            Что верно по линейности $L$. Аналогичный трюк используется для доказательства:
            $L^{-1}(\lambda x) = \lambda L^{-1}(x)$.
        \item
            \begin{itemize}
                \item
                    $L$~--- обратимо $\ora \forall$ базис $V$ переводится в базис $W$.

                    $e_1,\dots,e_n$~--- базис $V$, хотим показать, что $Le_1,\dots,Le_n$~--- базис $W$.
                    Проверим по определению, начав с образующей. Пусть $w\in W$, тогда
                    $L^{-1}(w)$ раскладывается по базису $e_1,\dots, e_n$, а значит $w$
                    раскладывается по базису $Le_1,\dots, Le_n$. 

                    Докажем линейную независимость: $\lambda_1Le_1 + \dots + \lambda_nLe_n=0$.
                    Подействуем на обе части $L^{-1}(x)$ и получим: $\lambda_1e_1+\dots+\lambda_ne_n=0$, 
                    что бывает только при тривиальных коэффициентах, так как $e_1,\dots,e_n$~--- базис.
                \item
                    Некоторый базис $V$ переходит в базис $W\ora L$~--- обратимо.

                    Берём некоторый базис $e_1,\dots,e_n \in V$, переходящий в базис 
                    $Le_1,\dots,Le_n \in W$. Построим линейное отображение $F$ со следующим свойством:
                    $F(Le_i)=e_i$. Такое существует и единственно 
                    \hyperref[thm:Линейное отображение определяется действием на базисных векторах]
                    {по теореме о том, что отображение однозначно задаётся действием на базисных векторах}.

                    Следующим шагом надо понять, что $F$ обратно $L$. Для этого можно проверить
                    только для базисных векторов, так как, если $F\circ L = id$ для базиса, то по 
                    \hyperref[thm:Линейное отображение определяется действием на базисных векторах]
                    {по той же теореме} $F\circ L = id$ будет выполняться и для всех элементов.
                    Проверка для произвольного $e_i$: $F(L(e_i)) = F(Le_i) = e_i$(просто по определению $F$).
                \item
                    Любой базис $V$ переходит в базис $W\ora $ некоторый базис $V$ переходит в базис $W$.

                    Очевидно, без комментариев.
            \end{itemize}
    \end{enumerate}
\end{proof}
\begin{definition}\leavevmode\\
    $L$~--- линейное $V\mapsto W$~--- изоморфизм $\Leftrightarrow$ $L$~--- обратимо\\
    $L$~--- линейное $V\mapsto W$~--- эпиморфизм $\Leftrightarrow$ $L$~--- сюръективно\\
    $L$~--- линейное $V\mapsto W$~--- мономорфизм $\Leftrightarrow$ $L$~--- инъективно
\end{definition}
\begin{remark}
    $V\simeq W(\text{изоморфизм})\Rightarrow  \dim V = \dim W$
    Причём изоморфизм однозначно определён выбором базисов для сопоставления.
\end{remark}
