\section{Лекция 04.04}
\subsection{Определитель}
\begin{theorem}[Свойства определителя]\leavevmode
    \begin{enumerate}
        \item $\det A$~--- форма объёма на $K^n$.
        \item Все формы объёма на $K^n$ пропорциональны $\det$.
        \item $\det A = \det A^T$.
        \item Элементарные преобразования строк и столбцов просто меняют определитель:
            \begin{enumerate}
                \item Элементарное преобразование первого типа не меняет определитель.
                \item Элементарное преобразование второго типа меняет знак определителя.
                \item Элементарное преобразования третьего типа, а именно умножение любой строки на $\lambda$ умножает
                    определитель на $\lambda$.
            \end{enumerate}
        \item  $\det(AB) = \det A\det B$.
        \item  $\left(\begin{array}{c|c}
                A & B\\
                \hline
                0 & C
        \end{array}\right) = \det A \det C
        .$ 
    \item $\det(A^{-1}) = (\det A)^{-1}$
    \end{enumerate}
\end{theorem}
\begin{proof}\leavevmode
    \begin{enumerate}
        \item 
            Докажем то, что $\det A$~--- форма объёма по определению.

            \begin{itemize}
                \item Проверим области определения и значений: $\det\colon M_n(K)\mapsto K \simeq (K^n)^n \mapsto K$.
                \item Полилинейнойсть:
                    Вспомним определение: 
                    $\det A = \sum\limits_{\sigma\in S_n} {\sgn\sigma \prod\limits_{i = 1}^{n}{a_{i, \sigma(i)}}}$. 
                    \begin{itemize}
                        \item 
                            Легко видеть, что в произведении элемент каждого столбца встречается ровно один раз.
                            Это значит, что если мы один из столбцов умножили на $\lambda$, то и в каждом слагаемом
                            произведение умножиться на $\lambda$, а значит и вся сумма умножится на $\lambda$. 
                            Свойство: $\lambda \det (v_1,\dots, v_n) = \det (v_1, \dots, \lambda v_i, \dots, v_n)$
                            считаем доказанным.
                        \item
                            \[
                            \begin{gathered}
                                \det (v_1,\dots, v_k + u, \dots, v_n) = 
                                \sum\limits_{\sigma\in S_n} {\sgn\sigma[v_k + u]_{\sigma(k)} \prod\limits_{\substack{i = 1\\i\not=k}}^{n}{[v_i]_{\sigma(i)}}}=\\=
                                \sum\limits_{\sigma\in S_n} {\sgn\sigma[v_k]_{\sigma(k)} \prod\limits_{\substack{i = 1\\i\not=k}}^{n}{[v_i]_{\sigma(i)}}}+
                                \sum\limits_{\sigma\in S_n} {\sgn\sigma[u]_{\sigma(k)} \prod\limits_{\substack{i = 1\\i\not=k}}^{n}{[v_i]_{\sigma(i)}}}=\\=
                                \det (v_1,\dots, v_k, \dots, v_n) + 
                                \det (v_1,\dots, u, \dots, v_n) 
                            \end{gathered}
                            \] 
                    \end{itemize}
                \item Кососимметричность проверяется по определению:
                    \[
                    \det A = \det(v_1,\dots, v_l,\dots, v_k,\dots, v_n) = 0, \text{если } v_l = v_k.
                    \]
                    Тогда можно расписать по определению:
                    \[
                        \det A = \sum\limits_{\sigma\in S_n}^{}{\sgn\sigma\prod\limits_{i=1}^{n}[v_i]_{\sigma(i)}}
                    \]
                    Заметим, что для получения группы всех нечетных перестановок из группы всех 
                    чётных можно воспользоваться следующей перестановкой: $\tau=(kl)$(на самом
                    деле тут могла быть любая перестановка $\gamma\colon \sgn(\gamma) = -1$)

                    Тогда, если вернуться к нашей формуле то её можно переписать так:
                    \[
                    \begin{gathered}
                        \det A = 
                        \sum\limits_{\substack{\sigma\in S_n\\\sgn(\sigma)=1}}
                        \left(\prod\limits_{i=1}^{n}[v_i]_{\sigma(i)}\right)
                            - 
                        \sum\limits_{\substack{\sigma\in S_n\\\sgn(\sigma)=1}}
                        \left(\prod\limits_{i=1}^{n}[v_i]_{\tau\sigma(i)}\right)
                        \\
                        \det A = 
                        \sum\limits_{\substack{\sigma\in S_n\\\sgn(\sigma)=1}}
                        \left(\prod\limits_{i=1}^{n}[v_i]_{\sigma(i)}- \prod\limits_{i=1}^{n}[v_i]_{\tau\sigma(i)}\right)
                        \\
                        \det A = 
                        \sum\limits_{\substack{\sigma\in S_n\\\sgn(\sigma)=1}}
                        \left([v_{\sigma^{-1}(k)}]_k [v_{\sigma^{-1}(l)}]_l \prod\limits_{\substack{i=1\\\sigma(i)\not=k,l}}^{n}[v_i]_{\sigma(i)}-
                        [v_{\sigma^{-1}(k)}]_{\tau(k)} [v_{\sigma^{-1}(l)}]_{\tau(l)} \prod\limits_{\substack{i=1\\\sigma(i)\not=k,l}}^{n}[v_i]_{\tau\sigma(i)}\right)
                    \end{gathered}
                    \]
                    Заметим, что если $\sigma(i)\not= k,l$, тогда $a_{i, \tau\sigma(i)} = a_{i,\sigma(i)}$.
                    Значит можно вынести произведение за скобки:
                    \[
                    \begin{gathered}
                        \det A = 
                        \sum\limits_{\substack{\sigma\in S_n\\\sgn(\sigma)=1}}
                        \left(\underbrace{\left([v_{\sigma^{-1}(k)}]_k [v_{\sigma^{-1}(l)}]_l -
                            [v_{\sigma^{-1}(k)}]_{\tau(k)} [v_{\sigma^{-1}(l)}]_{\tau(l)}\right)}_{=0}
                        \prod\limits_{\substack{i=1\\\sigma(i)\not=k,l}}^{n}[v_i]_{\sigma(i)}\right) = 0
                    \end{gathered}
                    \] 
                    Вспомнив, что $\tau(k) = l, \tau(l) = k$ по определению $\tau$, получаем, что каждое 
                    слагаемое равно нулю, следовательно и вся сумма равна нулю.
            \end{itemize}
        \item Любая форма объёма отличается от определителя умножением на число.

            \hyperref[stm:О пространстве форм объёма]{Доказано} в прошлый раз,
            так как все формы объёма определяются через определитель, умноженный
            на некоторую константу.
        \item $\det A = \det A^{T}$.

            Распишем по определению, после чего воспользуемся тем,
            что у любой перестановки есть обратная:
            \[
            \begin{gathered}
                \det A = \sum\limits_{\sigma\in S_n}^{}{\sgn\sigma\prod\limits_{i=1}^{n}a_{i,\sigma(i)}}
                =
                \sum\limits_{\sigma\in S_n}^{}{\sgn\sigma\prod\limits_{i=1}^{n}a_{\sigma^{-1}(i), i}}
                =\\=
                [\text{так как \hyperref[stm:Основные свойства перестановки]{знак обратной перестановки равен исходному}}]
                =\\=
                \sum\limits_{\sigma\in S_n}^{}{\sgn\sigma^{-1}\prod\limits_{i=1}^{n}a_{\sigma^{-1}(i), i}}
                =
                [\text{замена } \tau = \sigma^{-1}]
                =
                \sum\limits_{\tau\in S_n}^{}{\sgn\tau \prod\limits_{i=1}^{n}a_{\tau(i), i}}
                =\\=
                \sum\limits_{\tau\in S_n}^{}{\sgn\tau \prod\limits_{i=1}^{n}a^T_{i,\tau(i)}}
                =
                \det A^T
            \end{gathered}
            \]
        \item 
            \begin{enumerate}
                \item $\det A$ не меняется при первом элементарном преобразовании для матрицы $A$.

                    $\det$~--- полилинейное и кососимметричное. Тогда
                    \[
                        \det(\dots, u, \dots, v + \lambda u, \dots) = \det(\dots, u, \dots, v,\dots) +
                        \lambda \underbrace{\det(\dots, u,\dots, u,\dots)}_{=0\text{ по кососимметричности}}
                    .\]
                \item $\det A$ меняет знак при втором элементарном преобразовании для матрицы $A$.
                    
                    Очевидно по \hyperref[stm:Свойство кососимметричного отображения]{свойству кососимметричности}.
                \item
                    $\det A$ умножается на $\lambda$ при третьем элементарном преобразовании.
                    \[
                        \det (v_1,\dots, \lambda v_i, \dots, v_n) =[\text{по полилинейности } \det]= \lambda \det (v_1, \dots, v_i, \dots, v_n)
                    .\]
            \end{enumerate}
            Выше приведены доказательства для столбцов, доказательство для строк следует из этого
            автоматически так как $\det A = \det A^T$ по предыдущему свойству.
            \begin{remark}
                Таким образом можно считать определитель при помощи метода Гаусса постепенно 
                упрощая нашу матрицу. 
                Иногда бывает удобно использовать и преобразования строк и преобразования столбцов.
            \end{remark}
        \item
            $\det(AB) = \det A \det B$.

            Зададим следующую функцию $f(X) = \det(AX), f\colon (K^n)^n \mapsto K$. Утверждается, что $f$~--- форма объёма.
             \begin{itemize}
                 \item Кососимметричность. 

                     Пусть в $X$ есть два одинаковых столбца, тогда очевидно, что в $AX$ тоже есть два
                     одинаковых столбца. Тогда $f(X) = \det(AX) = 0$, так как $\det$~--- кососимметричное отображение.
                 \item Полилинейность. Следует из полилинейности определителя.
                     \[
                     \begin{gathered}
                     f\left((\dots, u+v,\dots)\right) =
                     \det A(\dots, u + v, \dots) =
                     \det \left(\dots, A(u + v), \dots\right)
                     =\\=
                     \det\left(\dots, Au + Av, \dots\right) =
                     \det\left(\dots, Au, \dots\right) + \det\left(\dots, Av, \dots\right) 
                     =\\=
                     \det A(\dots, u, \dots) + \det A(\dots, u, \dots) =
                     f\left(A(\dots, u,\dots)\right) + f\left(A(\dots, v,\dots)\right)
                     \end{gathered}
                     \]
                     Свойство $f\left((\dots, \lambda v, \dots)\right) = \lambda f\left(\dots, v, \dots\right)$
                     доказывается аналогичным образом.
             \end{itemize}
             Итак, $f$~--- форма объёма, значит она должна быть пропорциональна определителю: $f(X) = \lambda \det X$.
             Давайте найдём коэффициент пропорциональности $\lambda$ подставив $X = E$,
             тогда $\underbrace{f(E)}_{\det A} = \lambda \underbrace{\det E}_{1}$.
             Таким образом, получаем, что $\lambda = \det A$. Откуда, получаем:
             \[
                 f(X) = \det AX = \det A \det X
             .\]

         \item
            $\left(\begin{array}{c|c}
                    A & B\\
                    \hline
                    0 & C
            \end{array}\right) = \det A \det C
            .$

             Поступим примерно так же, как и с доказательством предыдущего пункта. Зададим форму объёма:
             \[
                 f(X) 
                 =
                 \det \left(\begin{array}{c|c}
                     X & B\\
                     \hline
                     0 & C
                 \end{array}\right)
             .\]
             Проверим, что $f$~--- форма объёма. Очевидна полилинейность,
             так как добавление нулей к векторам в $K^n$ ни на что не влияет.
             Кососимметричность так же получается за бесплатно, так как если в 
             $X$ есть два одинаковых столбца, то и в $
             \begin{pNiceArray}{c|c}[small]
                 X & B\\
                 \hline
                 0 & C
             \end{pNiceArray}
             $ они же и будут одинаковыми.

             Поэтому верно равенство: $f(X) = \lambda \det X$. Найдём $\lambda$, подставив
             $X = E_n$.
             \begin{equation}
                 \label{eq:8:1}
                 f(E_n) = \lambda \underbrace{\det E_n}_{=1} \Rightarrow \lambda =
                 \det \left(\begin{array}{c|c}
                         E_n & B\\
                         \hline
                         0 & C
                 \end{array}\right)
                 \Rightarrow
                 f(X) = 
                 \det \left(\begin{array}{c|c}
                         E_n & B\\
                         \hline
                         0 & C
                 \end{array}\right)
                 \det X
             .\end{equation}
             Посмотрим как это выражение зависит от $C$. 
             Для этого зададим новое отображение $g$ и зададим его следующим образом:
             \[
                 g(C) = 
                 \det \left(\begin{array}{c|c}
                         E_n & B \\
                         \hline
                         0 & C
                 \end{array}\right)
             \] 
             (доказывается аналогично док-ву для $X$). 
             Тогда $g(C) = \gamma \det C^T = \gamma \det C$. Как всегда, чтобы найти
             эту константу, подставим $C = E$, тогда получим:
             \[
                 g(E_m) = 
                 \det \left(\begin{array}{c|c}
                         E_n & B \\
                         \hline
                         0 & E_m
                 \end{array}\right)
                 = \gamma \underbrace{\det E_m}_{=1} 
                 \Rightarrow \gamma = 
                 \det \left(\begin{array}{c|c}
                         E_n & B \\
                         \hline
                         0 & E_m
                 \end{array}\right) = 1
                 \Rightarrow g(C) = \det C
             \]

             Подставив это в формулу \ref{eq:8:1}, получим, что
             $f(X) = \det C \det X$. Что и требовалось доказать.
         \item
             $\det A^{-1} = (\det A)^{-1}$.

             \[
             \begin{gathered}
                 \det A\cdot \det A^{-1} = \det(A\cdot A^{-1}) = \det E_n = 1
                 \\\Downarrow\\
                 \det A^{-1} = (\det A)^{-1}.
             \end{gathered}
             \]
    \end{enumerate}
\end{proof}
\subsection{Связь определителя с объёмом}
\begin{motivation}
    Вернёмся к тому, зачем мы вообще ввели определитель.
\end{motivation}
\begin{remark}
    $\abs{\det A} = \vol(\text{параллелепипед натянутый на столбцы $A$})$.
\end{remark}
\begin{proof}
    Верно, так как $\abs{\det A}$ удовлетворяет всем свойствам объёма, а именно:
    \begin{enumerate}
        \item $\vol(\dots, u, \dots, v+\lambda u,\dots) = \vol(\dots, u, \dots, v,\dots)$. 
        \item $\vol(\dots, \lambda u,\dots) = \abs{\lambda} \vol(\dots,u,\dots)$.
        \item  $\vol(E_n) = 1$
    \end{enumerate}
\end{proof}
\begin{remark}
    В совокупности эти 3 свойства позволяют нам вычислять объём параллелепипеда и модуль определителя.
    При помощи матрицу $A$ к матрице $L\in LT_n$ при помощи
    элементарных преобразований первого типа(алгоритм Гаусса для столбцов). Отметим, что $\det A = \det L$, так как
    преобразование первого типа не меняет объема.

    Теперь рассмотрим два случая:
    \begin{enumerate}
        \item $L$~--- вырожденная матрица, что равносильно тому, что её последний столбец равен нулю, а это значит, что она имеет нулевой объём.
        \item $L$~--- обратимая матрица. В этом случае объём ненулевой и равен произведению элементов на главной диагонали.
            Это несложно показать следующим образом. Разделим каждый столбец $L$ на константу так, чтобы на главной диагонали стояли только
            единицы, тем самым получив новую матрицу $\hat{L}$. Зная, что элементарное преобразование третьего типа умножает
            определитель на константу, получим, что $\det \hat{L} \prod\limits_{i=1}^{n}{l_{i,i}} = \det L$.
            Теперь легко понять, например по определению $\det$, что $\det \hat{L} = 1$, так как матрица является
            нижнетреугольной(то есть есть только одна перестановка с ненулевым произведением) и на диагоналях стоят единицы.

    \end{enumerate}
    При этом надо отметить, что при
    одинаковых преобразованиях $\abs{\det A}$ и $\vol()$ меняются на одинаковую величину, поэтому
    $\vol$ считается аналогичным образом.
\end{remark}
\begin{statement}[Критерий обратимости через определитель]
    $\det A = 0 \Leftrightarrow A\not\in GL_n$, иначе говоря $A$~--- необратимая(вырожденная).
\end{statement}
\begin{proof}
    Очевидно из описания алгоритма нахождения определителя матрицы выше.
\end{proof}
\subsection{Ориентация}
\begin{motivation}
    Поймём что даёт нам знание о знаке определителя.
\end{motivation}
\begin{definition}
    $V$~--- векторное пространство над  $\R$. $e_1,\dots, e_n$, $f_1,\dots, f_n$~--- базисы,
    тогда если $\det[id]^f_e>0$ тогда базисы называются одинаково ориентированными.
\end{definition}
\begin{remark}
    На самом деле определение ориентированности задаёт классы эквивалентности на множестве
    базисов пространства.
\end{remark}
\begin{definition}
    $L\colon V\mapsto V$. Тогда $L$ называется оператором.
\end{definition}
\begin{motivation}
    Хотим понять, как произвольный оператор влияет на ориентацию базиса.
\end{motivation}
\begin{definition}
    \label{def:определитель отображения}
    $L\colon V\mapsto V$. $\det L = \det[L]^e_e$, где $e$~--- произвольный базис.
\end{definition}
\begin{remark}
    Определитель матрицы любого линейного отображения $L$ не зависит от выбора базиса для того, чтобы
    задать это линейное отображение.
\end{remark}
\begin{proof}
    $[L]^e_e = [id]^f_e [L]^f_f [id]^e_f$. Значит, по 
     \hyperref[thm:Свойства определителя]{свойству определителя от обратного отображения}
    $[id]^f_e = ([id]^e_f)^{-1}$. Следовательно, $\det [id]^f_e = (\det [id]^e_f)^{-1}$.
    Значит $[L]^e_e = [L]^f_f$.
\end{proof}
\begin{definition}
    $e$~--- базис пространства $V$, $L\colon V\mapsto V$. Если $\det [L]^e_e = \det L > 0$, тогда говорят, что $L$~--- не меняет ориентацию.
\end{definition}
\begin{task}
    Доказать, что если $L$~--- не меняет ориентацию, то $e_1,\dots, e_n$ и $Le_1,\dots, Le_n$ одинаково ориентированны.
\end{task}
\begin{definition}
    $SL_n(K) = \left\{A\in M_n(K)\mid \det A = 1 \right\}$. Множество преобразований, которые не меняют ни объём ни ориентацию.
\end{definition}
\begin{example}
    Поворот плоскости, растяжение вдоль одной оси на $\lambda > 0$, а вдоль другой на $\frac{1}{\lambda}$.
\end{example}
\begin{remark}
    Чтобы было легче запомнить: $SL$~--- special linear, $GL$~--- general linear.
\end{remark}
\subsection{Формула разложения по строке или по столбцу}
\begin{motivation}
    Пока никакой явной пользы с вычислительной точки зрения определитель нам не принёс, но часто бывает,
    что он бывает весьма полезен при выражении каких-то объектов, но для этого было бы неплохо понимать 
    как определитель большего размера можно выражать через меньшие определители.
\end{motivation}
По определению $\det$ несложно заметить, что справедливо следующее равенство:
$\det A = C_1 a_{1,1} + \dots + C_n a_{n,1}$, где $C_i$~--- какие то константы для фиксированной $A$.
Давайте подумаем, каким образом можно найти эти коэффициенты. Самый простой вариант: 
меняем в $A$ первый столбец на $(\underbrace{0,\dots, 0}_{i-1}, 1, 0, \dots, 0)$, получаем $\hat{A}_i$,
тогда $C_i$ выражается следующим образом:

\[
\hat{A}_i = 
\begin{pNiceArray}{c|ccc}[first-col]
     &\Vdots&\Block{2-3}<\Large>{U}&&\\
     &0&&&\\
     \hline
   i\rightarrow&1&\Block{1-3}{*}&&\\
     \hline
     &0&\Block{2-3}<\Large>{D}&&\\
     &\Vdots&&&\\
\end{pNiceArray}
\Rightarrow
C_i = (-1)^i \det 
\begin{pNiceArray}{ccc}
     \Block{2-3}<\Large>{U}&&\\
     &&\\
     \hline
     \Block{2-3}<\Large>{D}&&\\
     &&\\
\end{pNiceArray}
\] 
Легко заметить, что запись получается очень громоздкой, поэтому давайте введём 
несколько новых определений. 

\begin{definition}
    $A\in M_{m\times n}(K)$. $I \subseteq \{1,\dots, m\}; J\subseteq \{1,\dots, n\}$.
    $A_{I,J}\in M_{\abs{I}\times\abs{J}}(K)$.
\end{definition}
\begin{definition}
    $A_{\overline{i}, \overline{j}} = A_{I,J}$, где 
    $I = \{1,\dots, m\}\setminus \{i\},
    J = \{1,\dots, n\}\setminus \{j\}$.
\end{definition}
\begin{statement}[Формула разложения]
    \[
        \det A = \sum\limits_{i=1}^{n}{(-1)^{i+j}\det\left(A_{\overline{i},\overline{j}}\right)a_{i,j}}, \forall j
    \]
\end{statement}
\begin{remark}
    Для строк работает в точности аналогично.
\end{remark}
\begin{proof}
Посмотрим на следующую матрицу:
\[
S = \begin{pNiceArray}{w{c}{1cm}|c|w{c}{1cm}}[first-col,first-row,small]
    &&\substack{i\\\downarrow}&\\
    &\Block{7-1}<\Large>{*}&0&\Block{7-1}<\Large>{*}\\
    &&\Vdots&\\
    &&0&\\
  j\rightarrow&&1&\\
    &&0&\\
    &&\Vdots&\\
    &&0&\\
\end{pNiceArray}
\]     
Давайте переставим строки и столбцы $S$ так,
чтобы единица оказалась в первой строчке первого столбца, получив матрицу следующего вида:
\[
\hat{S} = 
\begin{pNiceArray}{c|w{c}{1cm}}
     1&*\\
     \hline
     0&\Block{3-1}{A_{\overline{i},\overline{j}}}\\
     \Vdots&\\
     0&\\
\end{pNiceArray}
\]
По \hyperref[thm:Свойства определителя]{свойству определителя} о том, что при перестановке двух строк
или столбцов он меняет знак, получаем, что 
\[
    \det S = (-1)^{(i-1)+(j-1)}\det \hat{S}=(-1)^{i + j}\det \hat{S} = (-1)^{i+j}\det A_{\overline{i},\overline{j}}.
\]
Последнее следует опять таки из свойств определителя(а именно из свойства про определитель блочной матрицы,
один блок которой равен нулю).
\end{proof}
\begin{follow}
     (Формула Крамера)

     Решаем $Ax = b$, причём $A\in GL$, откуда следует, что система имеет единственное решение.
     Тогда утверждается, что решение задаётся следующей формулой:
    \[
        x_i = \frac{\Delta_i}{\Delta}, \Delta = \det A, 
        \Delta_i = \det\left(a_1, \dots, a_{i-1}, b, a_{i+1},\dots, a_n\right)   
    ,\] где $a_i$~--- столбцы матрицы $A$.
\end{follow}
\begin{proof}
    Заметим, что $b$ линейная комбинация столбцов $A$ с коэффициентами $x_i$.
    \[
        \Delta_i = \det\left(\dots,a_{i-1}, \sum\limits_{j=1}^{n}{x_ja_j}, a_{i+1},\dots\right)
    .\]
    Тогда если мы распишем это по линейности определителя, то все слагаемые 
    кроме одного сократятся по кососимметричности определителя. Следовательно
    \[
        \Delta_i = x_i\det\left(a_1,\dots,a_i,\dots, a_n\right) = x_i\det A
    .\]
    После этого равенства всё совсем очевидно. 
\end{proof}
\begin{definition}
    $\det A_{\overline{i},\overline{j}} = M_{i,j}$~--- $i,j$ минор матрицы $A$.
\end{definition}
\begin{definition}
    Алгебраическое дополнение(обозначается $A^{i,j}$) в точке $i, j$ определим следующим
    образом $A^{i,j} = (-1)^{i + j}M_{i,j}$. 
\end{definition}
\begin{definition}
    Присоединённой матрицей(обозн. $Adj A$) назовём следующую матрицу:\\ $(Adj A)_{i,j} = A^{j,i}$.
\end{definition}
\begin{statement}
    \[
        A^{-1} = \frac{AdjA}{\det A}
    \]
\end{statement}
\begin{proof}
    Упражнение.
\end{proof}
